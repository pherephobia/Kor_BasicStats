<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Probability into R | Basic Statistics and Data Analysis: Korean Version</title>
  <meta name="description" content="Chapter 4 Probability into R | Basic Statistics and Data Analysis: Korean Version" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Probability into R | Basic Statistics and Data Analysis: Korean Version" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Probability into R | Basic Statistics and Data Analysis: Korean Version" />
  
  
  

<meta name="author" content="Sanghoon Park" />


<meta name="date" content="2020-08-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch3.html"/>
<link rel="next" href="foundation-of-inference.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to <strong>R</strong></a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#기본-동작에-관한-소개"><i class="fa fa-check"></i><b>2.1</b> 기본 동작에 관한 소개</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#r의-연산자operations"><i class="fa fa-check"></i><b>2.2</b> <strong>R</strong>의 연산자(operations)</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#r의-기본적인-자료-유형"><i class="fa fa-check"></i><b>2.3</b> <strong>R</strong>의 기본적인 자료 유형</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#논리형-연산자-logical-operators"><i class="fa fa-check"></i><b>2.3.1</b> 논리형 연산자 (Logical operators)</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#벡터-vectors"><i class="fa fa-check"></i><b>2.4</b> 벡터 (Vectors)</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#매트릭스-matrices"><i class="fa fa-check"></i><b>2.5</b> 매트릭스 (Matrices)</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#데이터프레임-data-frame"><i class="fa fa-check"></i><b>2.6</b> 데이터프레임 (Data frame)</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#티블-tibbles"><i class="fa fa-check"></i><b>2.7</b> 티블 (Tibbles)</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#패키지-packages"><i class="fa fa-check"></i><b>2.8</b> 패키지 (Packages)</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#디렉토리-생성-코드"><i class="fa fa-check"></i><b>2.9</b> 디렉토리 생성 코드</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#용례-a-working-example"><i class="fa fa-check"></i><b>2.10</b> 용례 (A working example)</a></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#기타-참고자료"><i class="fa fa-check"></i><b>2.11</b> 기타 참고자료</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i><b>3</b> Introduction to Data</a><ul>
<li class="chapter" data-level="3.1" data-path="ch3.html"><a href="ch3.html#작업-디렉토리-설정"><i class="fa fa-check"></i><b>3.1</b> 작업 디렉토리 설정</a></li>
<li class="chapter" data-level="3.2" data-path="ch3.html"><a href="ch3.html#무작위-추출random-draws"><i class="fa fa-check"></i><b>3.2</b> 무작위 추출(Random Draws)</a></li>
<li class="chapter" data-level="3.3" data-path="ch3.html"><a href="ch3.html#루프-반복loops"><i class="fa fa-check"></i><b>3.3</b> 루프-반복(Loops)</a></li>
<li class="chapter" data-level="3.4" data-path="ch3.html"><a href="ch3.html#rplots를-파일의-형태로-저장하기"><i class="fa fa-check"></i><b>3.4</b> Rplots를 파일의 형태로 저장하기</a></li>
<li class="chapter" data-level="3.5" data-path="ch3.html"><a href="ch3.html#데이터-다루기-기본"><i class="fa fa-check"></i><b>3.5</b> 데이터 다루기 기본</a><ul>
<li class="chapter" data-level="3.5.1" data-path="ch3.html"><a href="ch3.html#데이터에-새로운-변수-더미변수-만들기"><i class="fa fa-check"></i><b>3.5.1</b> 데이터에 새로운 변수 &amp; 더미변수 만들기</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch3.html"><a href="ch3.html#다른-유형의-데이터-불러오기-loading-data-in-different-formats"><i class="fa fa-check"></i><b>3.5.2</b> 다른 유형의 데이터 불러오기 (Loading data in different formats)</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch3.html"><a href="ch3.html#자료-머징하기-using-data-merging"><i class="fa fa-check"></i><b>3.5.3</b> 자료 머징하기 (Using Data Merging)</a></li>
<li class="chapter" data-level="3.5.4" data-path="ch3.html"><a href="ch3.html#예제-correlatesofwar.org에서-capabilities-데이터셋을-불러오기3-3"><i class="fa fa-check"></i><b>3.5.4</b> 예제: correlatesofwar.org에서 capabilities 데이터셋을 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch3.html"><a href="ch3.html#요약통계표를-.tex-파일로-저장하기"><i class="fa fa-check"></i><b>3.6</b> 요약통계표를 .tex 파일로 저장하기</a></li>
<li class="chapter" data-level="3.7" data-path="ch3.html"><a href="ch3.html#서로-다른-분석수준lower-higher-통합하기"><i class="fa fa-check"></i><b>3.7</b> 서로 다른 분석수준(lower &amp; higher) 통합하기</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability-into-r.html"><a href="probability-into-r.html"><i class="fa fa-check"></i><b>4</b> Probability into R</a><ul>
<li class="chapter" data-level="4.1" data-path="probability-into-r.html"><a href="probability-into-r.html#주사위굴리기-게임"><i class="fa fa-check"></i><b>4.1</b> 주사위굴리기 게임!</a></li>
<li class="chapter" data-level="4.2" data-path="probability-into-r.html"><a href="probability-into-r.html#동전-던지기"><i class="fa fa-check"></i><b>4.2</b> 동전 던지기</a></li>
<li class="chapter" data-level="4.3" data-path="probability-into-r.html"><a href="probability-into-r.html#독립사건-시뮬레이션"><i class="fa fa-check"></i><b>4.3</b> 독립사건 시뮬레이션</a></li>
<li class="chapter" data-level="4.4" data-path="probability-into-r.html"><a href="probability-into-r.html#종속사건-시뮬레이션"><i class="fa fa-check"></i><b>4.4</b> 종속사건 시뮬레이션</a></li>
<li class="chapter" data-level="4.5" data-path="probability-into-r.html"><a href="probability-into-r.html#분포distribution"><i class="fa fa-check"></i><b>4.5</b> 분포(Distribution)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="probability-into-r.html"><a href="probability-into-r.html#정규분포-the-normal-distribution"><i class="fa fa-check"></i><b>4.5.1</b> 정규분포 (The normal distribution)</a></li>
<li class="chapter" data-level="4.5.2" data-path="probability-into-r.html"><a href="probability-into-r.html#이항분포-binomial-distribution"><i class="fa fa-check"></i><b>4.5.2</b> 이항분포 (Binomial distribution)</a></li>
<li class="chapter" data-level="4.5.3" data-path="probability-into-r.html"><a href="probability-into-r.html#포와송-분포-poison-distribution"><i class="fa fa-check"></i><b>4.5.3</b> 포와송 분포 (Poison distribution)</a></li>
<li class="chapter" data-level="4.5.4" data-path="probability-into-r.html"><a href="probability-into-r.html#음이항-분포-negative-binomial-distribution"><i class="fa fa-check"></i><b>4.5.4</b> 음이항 분포 (Negative Binomial Distribution)</a></li>
<li class="chapter" data-level="4.5.5" data-path="probability-into-r.html"><a href="probability-into-r.html#f-분포-f-distribution"><i class="fa fa-check"></i><b>4.5.5</b> F 분포 (F Distribution)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html"><i class="fa fa-check"></i><b>5</b> Foundation of Inference</a><ul>
<li class="chapter" data-level="5.1" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html#표본을-통한-모집단-추론-infer-population-using-samples"><i class="fa fa-check"></i><b>5.1</b> 표본을 통한 모집단 추론 (Infer Population using Samples)</a></li>
<li class="chapter" data-level="5.2" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html#평균의-차이difference-of-means-그리고-분산분석analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.2</b> 평균의 차이(difference of means), 그리고 분산분석(analysis of variance, ANOVA)</a><ul>
<li class="chapter" data-level="5.2.1" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html#평균-차이를-보는-이유"><i class="fa fa-check"></i><b>5.2.1</b> 평균 차이를 보는 이유</a></li>
<li class="chapter" data-level="5.2.2" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html#t-검정을-이용한-두-평균의-차이"><i class="fa fa-check"></i><b>5.2.2</b> t-검정을 이용한 두 평균의 차이</a></li>
<li class="chapter" data-level="5.2.3" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html#분산분석anova을-이용해-여러-평균을-비교하기"><i class="fa fa-check"></i><b>5.2.3</b> 분산분석(ANOVA)을 이용해 여러 평균을 비교하기</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="foundation-of-inference.html"><a href="foundation-of-inference.html#비율-차이-교차표와-카이스퀘어-검정chi-squared-tests"><i class="fa fa-check"></i><b>5.3</b> 비율 차이: 교차표와 카이스퀘어 검정(chi-squared tests)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="intoduction-to-simple-linear-regression-model.html"><a href="intoduction-to-simple-linear-regression-model.html"><i class="fa fa-check"></i><b>6</b> Intoduction to Simple Linear Regression Model</a><ul>
<li class="chapter" data-level="6.1" data-path="intoduction-to-simple-linear-regression-model.html"><a href="intoduction-to-simple-linear-regression-model.html#회귀분석의-이해-기울기의-검정"><i class="fa fa-check"></i><b>6.1</b> 회귀분석의 이해: 기울기의 검정</a></li>
<li class="chapter" data-level="6.2" data-path="intoduction-to-simple-linear-regression-model.html"><a href="intoduction-to-simple-linear-regression-model.html#좀-더-복잡한-회귀분석의-이해-다변량-회귀분석-multivariate-regression에-들어서기"><i class="fa fa-check"></i><b>6.2</b> 좀 더 복잡한 회귀분석의 이해: 다변량 회귀분석 (multivariate regression)에 들어서기</a></li>
<li class="chapter" data-level="6.3" data-path="intoduction-to-simple-linear-regression-model.html"><a href="intoduction-to-simple-linear-regression-model.html#단순회귀분석-심화"><i class="fa fa-check"></i><b>6.3</b> 단순회귀분석 심화</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html"><i class="fa fa-check"></i><b>7</b> Better Understanding for Linear Model</a><ul>
<li class="chapter" data-level="7.1" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#추정estimation"><i class="fa fa-check"></i><b>7.1</b> 추정(Estimation)</a><ul>
<li class="chapter" data-level="7.1.1" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#점추정과-구간추정point-estimation-and-interval-estimation"><i class="fa fa-check"></i><b>7.1.1</b> 점추정과 구간추정(point estimation and interval estimation)</a></li>
<li class="chapter" data-level="7.1.2" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#신뢰구간-평균과-비율"><i class="fa fa-check"></i><b>7.1.2</b> 신뢰구간: 평균과 비율</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#유의성-검정significnace-tests"><i class="fa fa-check"></i><b>7.2</b> 유의성 검정(Significnace Tests)</a><ul>
<li class="chapter" data-level="7.2.1" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#유의성-검정을-이루는-다섯-가지-부분"><i class="fa fa-check"></i><b>7.2.1</b> 유의성 검정을 이루는 다섯 가지 부분</a></li>
<li class="chapter" data-level="7.2.2" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#오류의-유형-types-of-errors"><i class="fa fa-check"></i><b>7.2.2</b> 오류의 유형 (Types of Errors)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#선형회귀와-상관관계"><i class="fa fa-check"></i><b>7.3</b> 선형회귀와 상관관계</a><ul>
<li class="chapter" data-level="7.3.1" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#선형관계"><i class="fa fa-check"></i><b>7.3.1</b> 선형관계</a></li>
<li class="chapter" data-level="7.3.2" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#확률모델probability-model"><i class="fa fa-check"></i><b>7.3.2</b> 확률모델(Probability model)</a></li>
<li class="chapter" data-level="7.3.3" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#선형회귀모델"><i class="fa fa-check"></i><b>7.3.3</b> 선형회귀모델</a></li>
<li class="chapter" data-level="7.3.4" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#관계의-측정-상관관계"><i class="fa fa-check"></i><b>7.3.4</b> 관계의 측정: 상관관계</a></li>
<li class="chapter" data-level="7.3.5" data-path="better-understanding-for-linear-model.html"><a href="better-understanding-for-linear-model.html#정리하며"><i class="fa fa-check"></i><b>7.3.5</b> 정리하며</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introduction-to-multivariate-linear-regression-model.html"><a href="introduction-to-multivariate-linear-regression-model.html"><i class="fa fa-check"></i><b>8</b> Introduction to Multivariate Linear Regression Model</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-multivariate-linear-regression-model.html"><a href="introduction-to-multivariate-linear-regression-model.html#관계와-인과성"><i class="fa fa-check"></i><b>8.1</b> 관계와 인과성</a></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-multivariate-linear-regression-model.html"><a href="introduction-to-multivariate-linear-regression-model.html#변수의-통제"><i class="fa fa-check"></i><b>8.2</b> 변수의 통제</a><ul>
<li class="chapter" data-level="8.2.1" data-path="introduction-to-multivariate-linear-regression-model.html"><a href="introduction-to-multivariate-linear-regression-model.html#다변량-관계multivariate-relationship"><i class="fa fa-check"></i><b>8.2.1</b> 다변량 관계(Multivariate relationship)</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-multivariate-linear-regression-model.html"><a href="introduction-to-multivariate-linear-regression-model.html#다중선형회귀모델multiple-linear-regression-model"><i class="fa fa-check"></i><b>8.3</b> 다중선형회귀모델(Multiple linear regression model)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Basic Statistics and Data Analysis: Korean Version</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability-into-r" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Probability into R</h1>
<p>확률 관련 포스팅에서는 몇 가지 간단한 확률을 <strong>R</strong>을 통해서 증명하고(Some simple probability demonstrations), 정규분포(normal distributions)와 이항분포(binomial distributions)로부터 분위(quantiles)를 얻어내는 방법을 살펴보고자 합니다.</p>
<p>여기서는 일단 간단하게 정규분포랑 이항분포, 그리고 독립사건과 종속사건만 간단하게 살펴보겠습니다.</p>
<ul>
<li>분위(Quantiles)에 대해 어떻게 설명할까 고민을 좀 했는데 좋은 블로그 포스팅을 찾아서 참조용으로 링크하겠습니다.</li>
<li>링크는 <a href="https://blog.naver.com/sw4r/221026102874">여기</a>를 보시면 됩니다. Q-Q Plot 설명하면서 Quantile의 정의도 잘 정리해놓으셨습니다.</li>
</ul>
<p>그럼 본격적으로 포스팅을 시작하기에 앞서서 항상 그렇듯이 작업 디렉토리를 설정해보겠습니다.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="probability-into-r.html#cb187-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) <span class="co"># 현재 콘솔 창에 저장되어 있는 모든 값과 모델 등을 삭제 </span></span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="probability-into-r.html#cb188-1"></a><span class="kw">library</span>(here)</span>
<span id="cb188-2"><a href="probability-into-r.html#cb188-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb188-3"><a href="probability-into-r.html#cb188-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb188-4"><a href="probability-into-r.html#cb188-4"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb188-5"><a href="probability-into-r.html#cb188-5"></a><span class="kw">library</span>(kableExtra)</span>
<span id="cb188-6"><a href="probability-into-r.html#cb188-6"></a>here<span class="op">::</span><span class="kw">here</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">setwd</span>()</span></code></pre></div>
<div id="주사위굴리기-게임" class="section level2">
<h2><span class="header-section-number">4.1</span> 주사위굴리기 게임!</h2>
<p>확률을 공부할 때, 지겹도록 등장하는 놈들이 총 셋이 있습니다. 동전, 카드, 그리고 주사위입니다. 인류는 아마도 이 셋을 만듦으로써 스스로를 괴롭히는 통계학을 발전시켰는지도 모르겠습니다… 일단 주사위 굴리기는 직관적으로 확률과 통계를 이해하기 좋은 방식입니다. 먼저 주사위 하나를 한 번 굴리는 것을 시뮬레이팅하는 함수를 코딩해보겠습니다.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="probability-into-r.html#cb189-1"></a>die &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>))</span>
<span id="cb189-2"><a href="probability-into-r.html#cb189-2"></a>die</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p><code>die</code>는 <code>?runif</code> 라고 입력하여 살펴보면 <code>generates random deviates.</code>라고 기술되어 있는 것을 확인할 수 있습니다. 이어지는 함수를 풀어서 설명하면 다음과 같습니다.: 다음의 결과를 정수의 형태로 저장하라(<code>as.integer</code>) <span class="math inline">\(\rightarrow\)</span> 무작위로 다음의 범주 내에서 다른 값을 1번 추출하라 <span class="math inline">\(\rightarrow\)</span> 최소값은 1, 최대값은 6 (1 이상 7미만)을 갖게하라.</p>
<p>그러면 이번에는 두 개의 주사위를 굴려보도록 하겠습니다. 굴리는 횟수는 한 번입니다.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="probability-into-r.html#cb191-1"></a>dice &lt;-<span class="st"> </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>))) <span class="op">+</span></span>
<span id="cb191-2"><a href="probability-into-r.html#cb191-2"></a><span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>)))</span>
<span id="cb191-3"><a href="probability-into-r.html#cb191-3"></a>dice</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>여기서 <code>+</code> 연산자는 부울리안 논리에 따르면 <code>OR</code>를 의미합니다. 즉 각 주사위를 한 번씩 랜덤으로 굴려 얻는 값을 더한 결과를 <code>dice</code>에 저장하라는 명령입니다. 그럼 이번에는 100번, 1000번, 그리고 100만번을 돌려겠습니다.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="probability-into-r.html#cb193-1"></a><span class="co"># 주사위 두 개를 100번 던져보기</span></span>
<span id="cb193-2"><a href="probability-into-r.html#cb193-2"></a>dice100 &lt;-<span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">100</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>))) <span class="op">+</span></span>
<span id="cb193-3"><a href="probability-into-r.html#cb193-3"></a><span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">100</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>)))</span>
<span id="cb193-4"><a href="probability-into-r.html#cb193-4"></a></span>
<span id="cb193-5"><a href="probability-into-r.html#cb193-5"></a><span class="co"># 주사위 두 개를 1,000번 던져보기</span></span>
<span id="cb193-6"><a href="probability-into-r.html#cb193-6"></a>dice1000 &lt;-<span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1000</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>))) <span class="op">+</span></span>
<span id="cb193-7"><a href="probability-into-r.html#cb193-7"></a><span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1000</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>)))</span>
<span id="cb193-8"><a href="probability-into-r.html#cb193-8"></a></span>
<span id="cb193-9"><a href="probability-into-r.html#cb193-9"></a><span class="co"># 주사위 두 개를 100만 번 던져보기</span></span>
<span id="cb193-10"><a href="probability-into-r.html#cb193-10"></a>dice1M &lt;-<span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1000000</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb193-11"><a href="probability-into-r.html#cb193-11"></a><span class="st">  </span>(<span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">1000000</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">7</span>)))</span></code></pre></div>
<p>이렇게 시뮬레이팅한 세 결과를 히스토그램으로 살펴보겠습니다.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="probability-into-r.html#cb194-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb194-2"><a href="probability-into-r.html#cb194-2"></a><span class="kw">hist</span>(dice1000)</span>
<span id="cb194-3"><a href="probability-into-r.html#cb194-3"></a><span class="kw">hist</span>(dice100)</span>
<span id="cb194-4"><a href="probability-into-r.html#cb194-4"></a><span class="kw">hist</span>(dice1M)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-83-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>일단 가시적으로 살펴볼 수 있게 각 코드 이후에 그 결과값의 빈도를 표로 나타내보았습니다. 그리고 그 표를 히스토그램으로 재구성해보았습니다. 역시 <code>N</code>이 늘어날 수록 우리(?)가 사랑하는 그 녀석의 모습이 드러나기 시작합니다.</p>
<p>주사위는 1에서 6까지의 한정된 값을 가지고, 두 개를 합쳐서 굴려봐야 2부터 12까지의 한정된(bounded) 값이긴 하지만 이 주사위 굴리기를 통해서 우리는 지난 번 포스팅에서 살펴보았던 것처럼 정규분포(normal distribution)와 표본 크기(n), 혹은 표집(sampling)의 관계를 간접적으로 다시 한 번 살펴볼 수 있습니다.</p>
</div>
<div id="동전-던지기" class="section level2">
<h2><span class="header-section-number">4.2</span> 동전 던지기</h2>
<p>그럼 이번에는 동전을 한 번 던져보겠습니다. 저는 아직까지 앞면 뒷면 이외에 옆면에도 표기를 지닌 동전을 본 적이 없으니, 여기서의 동전도 앞면과 뒷면이라는 두 개의 값만을 가진다고 가정하겠습니다. 삼면이나 사면을 가진 동전을 보신 분들은 부디 댓글로 알려주시길… 나와라 검은 백조야(김웅진 · 김지희 2012, p.53).</p>
<p>아무튼 앞면과 뒷면이 있는 경우에 그 각각이 나올 확률은 0.5, 0.5라고 할 수 있습니다. <code>rbinom()</code>은, randomly [drawn] binomial, 무작위로 이항변수를 추출하라는 함수라고 할 수 있습니다. 백문이 불여일코드.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="probability-into-r.html#cb195-1"></a>coin &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.5</span>)</span>
<span id="cb195-2"><a href="probability-into-r.html#cb195-2"></a>coin</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>이어지는 함수를 풀어서 설명하면 다음과 같습니다.: 이항변수로 무작위로 추출하라(<code>rbinom()</code>) <span class="math inline">\(\rightarrow\)</span> 1번 추출하라 <span class="math inline">\(\rightarrow\)</span> 최대값은 1 (=최소값은 0) <span class="math inline">\(\rightarrow\)</span> 추출확률은 0.5. 즉, 1이 나올 확률을 50%로 설정하여 무작위로 추출하라는 것입니다. 그럼 이번에는 100개의 동전을 던져보겠습니다.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="probability-into-r.html#cb197-1"></a><span class="co"># 동전 100개 던지기</span></span>
<span id="cb197-2"><a href="probability-into-r.html#cb197-2"></a>coin100 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">.5</span>)</span>
<span id="cb197-3"><a href="probability-into-r.html#cb197-3"></a>coin100 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">table</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
.
</th>
<th style="text-align:right;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
49
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
51
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="probability-into-r.html#cb198-1"></a><span class="co">#동전 1000개 던지기</span></span>
<span id="cb198-2"><a href="probability-into-r.html#cb198-2"></a>coin1000 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1000</span>, <span class="dv">1</span>, <span class="fl">.5</span>)</span>
<span id="cb198-3"><a href="probability-into-r.html#cb198-3"></a>coin1000 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">table</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
.
</th>
<th style="text-align:right;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
493
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
507
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="probability-into-r.html#cb199-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb199-2"><a href="probability-into-r.html#cb199-2"></a><span class="kw">hist</span>(coin100)</span>
<span id="cb199-3"><a href="probability-into-r.html#cb199-3"></a><span class="kw">hist</span>(coin1000)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-85-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>이와 같이 이항변수는 나뉘어진(discrete) 값을 가집니다. 히스토그램으로 그리면 0이 나오는 빈도랑 1이 나오는 빈도만 보여주는 것이지요. 이번에는 100개의 동전을 1000번 던지는 경우를 시뮬레이팅해보겠습니다.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="probability-into-r.html#cb200-1"></a>coin1Mx &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">1000000</span>)</span>
<span id="cb200-2"><a href="probability-into-r.html#cb200-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000000</span>){</span>
<span id="cb200-3"><a href="probability-into-r.html#cb200-3"></a>coin1Mx[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">.5</span>))</span>
<span id="cb200-4"><a href="probability-into-r.html#cb200-4"></a>}</span>
<span id="cb200-5"><a href="probability-into-r.html#cb200-5"></a><span class="kw">hist</span>(coin1Mx, </span>
<span id="cb200-6"><a href="probability-into-r.html#cb200-6"></a>     <span class="dt">freq =</span> <span class="ot">FALSE</span>, </span>
<span id="cb200-7"><a href="probability-into-r.html#cb200-7"></a>     <span class="dt">main =</span> <span class="st">&quot;Distribution of heads</span><span class="ch">\n</span><span class="st"> in 100 coin tosses&quot;</span>, </span>
<span id="cb200-8"><a href="probability-into-r.html#cb200-8"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Number of heads&quot;</span>)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-86-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>100만 개의 셀을 결측치(<code>NA</code>)로 갖는 텅빈 <code>coinMx</code>라는 벡터를 만들어보겠습니다. 그리고 <code>i</code>가 1에서 100만까지 반복되는 <code>loop</code>를 구성합니다. <code>coin1Mx_1</code>부터 <code>coin1Mx_1000000</code>까지 총 100만개의 <code>coin1Mx_n</code>들은 모두 100개의 동전을 던져서 앞면(1)이 나오는 경우의 수를 더한 각각의 값을 가질 것입니다. 따라서 <code>coin1Mx</code>는 100만개의 요소를 지닌 벡터입니다.</p>
<p>이 자료를 활용해서 만약 100개를 던졌을 때, 앞면이 60번 나오는 것이 과연 극단적인 확률일지 아니면 무던한 것일지 확인해보겠습니다자. 60번 이상 앞면이 나온 경우를 세는 함수를 짜보겠습니다.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="probability-into-r.html#cb201-1"></a><span class="kw">table</span>(coin1Mx[coin1Mx <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>])</span></code></pre></div>
<pre><code>## 
##   61   62   63   64   65   66   67   68   69   70   71   72   73 
## 7037 4474 2648 1589  854  476  229  110   63   20   15    4    3</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="probability-into-r.html#cb203-1"></a>coin1Mx[coin1Mx <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">table</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
61
</th>
<th style="text-align:right;">
62
</th>
<th style="text-align:right;">
63
</th>
<th style="text-align:right;">
64
</th>
<th style="text-align:right;">
65
</th>
<th style="text-align:right;">
66
</th>
<th style="text-align:right;">
67
</th>
<th style="text-align:right;">
68
</th>
<th style="text-align:right;">
69
</th>
<th style="text-align:right;">
70
</th>
<th style="text-align:right;">
71
</th>
<th style="text-align:right;">
72
</th>
<th style="text-align:right;">
73
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
7037
</td>
<td style="text-align:right;">
4474
</td>
<td style="text-align:right;">
2648
</td>
<td style="text-align:right;">
1589
</td>
<td style="text-align:right;">
854
</td>
<td style="text-align:right;">
476
</td>
<td style="text-align:right;">
229
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>앞면이 나오는 빈도가 61번 이상부터는 점차 감소하는 것을 확인할 수 있습니다. 그렇다면 이번에는 앞면이 60번 넘게 나올 확률을 구해보겠습니다.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="probability-into-r.html#cb204-1"></a><span class="kw">length</span>(coin1Mx[coin1Mx <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>])<span class="op">/</span><span class="kw">length</span>(coin1Mx)</span></code></pre></div>
<pre><code>## [1] 0.017522</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="probability-into-r.html#cb206-1"></a><span class="kw">sum</span>(<span class="kw">table</span>(coin1Mx[coin1Mx <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>]))<span class="op">/</span><span class="dv">1000000</span></span></code></pre></div>
<pre><code>## [1] 0.017522</code></pre>
<p><code>length()</code>는 <code>count()</code>랑 같은 개념이라고 할 수 있습니다. 전체 <code>coin1Mx</code>의 수, 즉 100만 건 중에서 앞면이 60번보다 많이 나온 경우의 수가 어느 정도인지를 계산한 것입니다. 즉, 앞면이 60번보다 더 많이 나올 확률은 매우 작다고 할 수 있습니다다. 앞면이 60번 초과하여 나올 확률은 “평균적” or “일반적”인 것은 아니라는 뜻입니다.</p>
</div>
<div id="독립사건-시뮬레이션" class="section level2">
<h2><span class="header-section-number">4.3</span> 독립사건 시뮬레이션</h2>
<p>두 개의 독립적인 사건을 시뮬레이션해보겠습니다. 첫 번째 함수는 <code>rand1</code>이라는 자료에 최소값 0, 최대값 10 미만의 값을 가지는 100개의 수를 무작위로 담으라는 명령입니다. 두 번째 함수는 정규분포를 따라 평균이 0이고 표준편차가 2의 값을 갖는 분포에서 100개의 값을 무작위로 추출해 rand2라는 자료에 담으라는 명령입니다.</p>
<ul>
<li>일단 보면 <code>rand2</code>의 경우, 비록 명령으로 평균을 0으로 하라고 설정했지만 무작위 추출 결과 100개의 값의 평균은 0보다 약간 큰 것을 확인할 수 있습니다.
<ul>
<li>이제 두 값을 각각 <code>x</code>축, <code>y</code>축으로 설정하여 100개의 값을 좌표에 매칭시킨 그래프로 나타내보겠습니다.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="probability-into-r.html#cb208-1"></a>rand1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">10</span>)</span>
<span id="cb208-2"><a href="probability-into-r.html#cb208-2"></a><span class="kw">summary</span>(rand1)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.03412 3.09706 5.40381 5.14779 7.22230 9.82459</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="probability-into-r.html#cb210-1"></a>rand2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb210-2"><a href="probability-into-r.html#cb210-2"></a><span class="kw">summary</span>(rand2)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -5.24249 -1.30019  0.16829  0.09442  1.37764  5.01674</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="probability-into-r.html#cb212-1"></a><span class="kw">plot</span>(rand1, rand2)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-89-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>결과적으로 이 그래프에서 우리는 <code>rand1</code>과 <code>rand2</code> 간에는 어떠한 경향성을 발견하기 힘듭니다. 즉, 독립적이라는 것은 두 변수 간에 어떠한 관계를 상정할 수 없다는 것으로 이해할 수 있습니다.</p>
</div>
<div id="종속사건-시뮬레이션" class="section level2">
<h2><span class="header-section-number">4.4</span> 종속사건 시뮬레이션</h2>
<p>이번에는 두 사건이 종속적 관계에 있는, 즉 한 사건에서의 변화가 다른 사건에 영향을 미치는 경우를 시뮬레이션해 보겠습니다.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="probability-into-r.html#cb213-1"></a>rand3 &lt;-<span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.75</span> <span class="op">*</span><span class="st"> </span>rand1 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><code>rand3</code>는 아까 만들어놓은 <code>rand1</code>에다가 0.75를 곱해서 4를 더한 100개의 값에다가 사실 상 <code>rand2</code>와 같은 방식으로 구한 값을 더하여 구한 자료입니다. 즉, 이 값은 <code>rand1</code>의 값에 어떠한 조치를 취하여 얻은 값이므로 <code>rand1</code>에 영향을 받은 결과물이라고 할 수 있습니다. 이렇게 구한 <code>rand3</code>와 <code>rand1</code> 간의 관계를 그래프로 나타내봅시다.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="probability-into-r.html#cb214-1"></a><span class="kw">plot</span>(rand1, rand3)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-91-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>이 그래프의 해석은 나중에 산포도(scatter plot) 및 단순회귀분석(simple regression)을 살펴볼 때 다시 한 번 다룰 것입니다. 일단 여기서는 <code>rand1</code>이 증가할 때, <code>rand3</code>도 증가세를 보이는—둘의 인과적 관계는 확인할 수 없지만 아무튼—양(positive)의 관계를 보이고 있다는 것을 알 수 있습니다.</p>
<p><code>cor(rand1, rand3)</code>로 두 변수 간의 상관계수를 구해보면<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>, 양수의 기울기를 얻게 됩니다.</p>
<p>이번에는 보다 더 불확실성을 가지는 종속사건의 관계를 시뮬레이션해보겠습니다. 여기서 말하는 불확실성은 더 큰 표준편차를 의미합니다.</p>
<ul>
<li>표준편차가 평균에서 각 관측치가 떨어져 있는 거리의 평균이라고 할 때,
<ul>
<li>표준편차 값이 크다는 것은 개별 값들이 평균에서 더 넓게 분포해 있다는 것을 의미합니다.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="probability-into-r.html#cb215-1"></a>rand4 &lt;-<span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.75</span> <span class="op">*</span><span class="st"> </span>rand1 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</span>
<span id="cb215-2"><a href="probability-into-r.html#cb215-2"></a><span class="kw">plot</span>(rand1, rand4)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-92-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="probability-into-r.html#cb216-1"></a><span class="kw">cor</span>(rand1, rand4)</span></code></pre></div>
<pre><code>## [1] 0.4538117</code></pre>
<p><code>rand1</code>과 <code>rand4</code>의 산포도는 좀 더 넓게 퍼진 모양새를 보이고 둘의 상관관계는 식에서 상정한 0.75라는 기울기에서 0.456으로 더 낮아지는 것을 확인할 수 있습니다.</p>
</div>
<div id="분포distribution" class="section level2">
<h2><span class="header-section-number">4.5</span> 분포(Distribution)</h2>
<p>통계분석에 앞서서 일반적으로 알아두어야 할분포 함수(distribution functions)를 살펴보겠습니다. 먼저, 정규분포(normal distributions)와 이항분포(binomial distributions)로부터 분위(quantiles)를 얻어내는 방법을 살펴보겠습니다.</p>
<div id="정규분포-the-normal-distribution" class="section level3">
<h3><span class="header-section-number">4.5.1</span> 정규분포 (The normal distribution)</h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="probability-into-r.html#cb218-1"></a><span class="kw">pnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.9772499</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="probability-into-r.html#cb220-1"></a><span class="kw">pnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.02275013</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="probability-into-r.html#cb222-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.02275013</code></pre>
<p>첫번째 코드는 50을 평균으로 하고 10을 표준편차로 하는 정규분포가 있을 때, 그 분포에서 70이라는 숫자는 어디에 위치하는지를 묻는 것입니다.</p>
<p>두 번째도 동일한 의미인데, 두 식의 차이는 <code>lower.tail</code> 옵션을 어떻게 설정하느냐에 달려있습니다.</p>
<ul>
<li>각 식이 도출한 결과를 보면 이해하시겠지만 근본적으로 두 식은 동일하며, 좌측에서 누적확률을 계산할 것인지 우측으로부터 계산할 것인지의 차이일 뿐입니다.
<ul>
<li>간단하게 말하면 첫 번째 식은 70이라는 숫자는 이 분포에서 하위 97.7%에 위치한 값이다라고 말하는 것이고 두 번째 식은 상위 2.2%라고 말하는 것입니다.</li>
<li>따라서 두 번째 식은 전체 확률에서 첫 번째 식으로 계산한 확률을 제한 값과 같으므로 세 번째의 형태로 계산할 수도 있습니다.</li>
</ul></li>
</ul>
<p>그렇다면 만약에 양측꼬리 확률(two-tailed probability)에서 최소한 70만큼 ‘극단적인’(extreme) 확률을 얻고 싶을 때는 어떻게 해야할까요? 이 경우는 생각을 좀 달리 해보면 됩니다. 평균을 기점으로 70은 오른쪽 끝쪽에 위치하는 셈입니다. 그만큼 왼쪽 끝에 위치한 값을 상정하고 그 값이 나올 확률을 함께 계산해주어야 합니다.</p>
<p>이 경우 평균 50에서 70은 20만큼 떨어져 있습니다(우측으로, + 방향). 따라서 우리는 좌측으로 20만큼 떨어진 30이 나올 확률을 함께 고려해주어야 하는 것입니다. 이러한 결과를 얻는 데는두 가지 방법이 존재합니다.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="probability-into-r.html#cb224-1"></a><span class="co">## 첫 번째 방법</span></span>
<span id="cb224-2"><a href="probability-into-r.html#cb224-2"></a><span class="kw">pnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb224-3"><a href="probability-into-r.html#cb224-3"></a><span class="st">  </span><span class="kw">pnorm</span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.04550026</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="probability-into-r.html#cb226-1"></a><span class="co">## 두 번째 방법</span></span>
<span id="cb226-2"><a href="probability-into-r.html#cb226-2"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.04550026</code></pre>
<p>그렇다면 이렇게 구한 분포에서의 누적확률 값을 가지고 분위를 구하여 보겠습니다. 마찬가지로 평균 50에 표준편차가 10인 분포를 상정합니다. 이때 사용할 함수는 <code>qnorm()</code>입니다.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="probability-into-r.html#cb228-1"></a><span class="kw">qnorm</span>(<span class="fl">0.9772499</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 70.00001</code></pre>
<p>역으로 계산한 것인데, 평균 50에 표준편차 10인 분포에서 좌측부터 앞서 구한 누적확률에 해당하는 값을 구하라는 명령입니다. 앞에서 우리가 입력한 70과 근사한 값을 얻을 수 있습니다. 근소한 차이는 소수점에 의해 발생하는 것으로 이해하시면 됩니다.</p>
<p>다음으로는 주어진 평균 50, 표준편차 10의 분포에서 70이라는 값이 분포에서 차지하는 밀도를 확인해보겠습니다 밀도(density)를 알아보기 위한 함수는 다음과 같습니다.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="probability-into-r.html#cb230-1"></a><span class="kw">dnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.005399097</code></pre>
<p>그렇다면 이번에는 정규분포에서 관측치를 무작위로 추출(draws)을 해보겠습니다. 이번에도 함수에는 70이라는 값이 사용될 것인데, 여기서 사용되는 70은 특정한 값이 아니라 추출 횟수를 의미합니다.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="probability-into-r.html#cb232-1"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">70</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb232-2"><a href="probability-into-r.html#cb232-2"></a>x</span></code></pre></div>
<pre><code>##  [1] 46.50611 44.46011 59.85180 56.92038 45.28452 49.17147 39.05260 56.88268
##  [9] 62.86121 45.12872 45.20455 39.95431 54.01066 37.02523 54.12853 47.57958
## [17] 42.86466 30.18120 53.70887 41.92637 36.82987 56.26902 52.30013 40.97493
## [25] 53.09003 67.75457 38.71713 39.08685 39.70970 47.70983 48.91331 38.67013
## [33] 37.66809 40.28761 65.26439 30.72966 39.45501 49.60163 58.10184 54.23234
## [41] 45.48162 51.33822 27.18815 47.93246 44.07059 38.89544 51.20265 44.47311
## [49] 54.69822 63.85507 49.71985 33.29094 51.64303 47.85751 53.53842 50.65780
## [57] 52.42276 39.65340 64.79593 59.58894 43.14126 57.72921 54.33396 62.13203
## [65] 48.01102 36.79469 60.32323 57.82806 41.62079 56.50440</code></pre>
<p>총 70개의 값이 무작위로 추출되어 <code>x</code>라는 벡터에 담겨 있는 것을 확인할 수 있습니다.</p>
<p>이번에는 좀 더 구체적으로 정규분포 사례들을 살펴보겠습니다. 서로 다른 평균(mean)과 표준편차(standard deviation)를 가지는 세 개의 정규분포를 그려보겠습니다.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="probability-into-r.html#cb234-1"></a>normal5 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>)</span>
<span id="cb234-2"><a href="probability-into-r.html#cb234-2"></a>normal50 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb234-3"><a href="probability-into-r.html#cb234-3"></a>normal20 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">mean =</span> <span class="dv">20</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>세 함수 모두 표본의 크기는 1만 개이며, 각자 다른 평균과 표준편차를 따르는 정규분포를 가정하여 무작위로 추출된 값을 담는 벡터로 출력됩니다. 이렇게 값을 갖는 세 개의 벡터를 하나의 데이터로 합쳐보겠습니다. 간단하게 말하면 하나의 표로 합친다는 것과 같습니다.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="probability-into-r.html#cb235-1"></a>norm &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">x =</span> normal5, <span class="dt">Mean =</span> <span class="dv">5</span>, <span class="dt">SD =</span> <span class="dv">3</span>),</span>
<span id="cb235-2"><a href="probability-into-r.html#cb235-2"></a>                  <span class="kw">tibble</span>(<span class="dt">x =</span> normal50, <span class="dt">Mean =</span> <span class="dv">50</span>, <span class="dt">SD =</span> <span class="dv">10</span>),</span>
<span id="cb235-3"><a href="probability-into-r.html#cb235-3"></a>                  <span class="kw">tibble</span>(<span class="dt">x =</span> normal20, <span class="dt">Mean =</span> <span class="dv">20</span>, <span class="dt">SD =</span> <span class="dv">1</span>))</span>
<span id="cb235-4"><a href="probability-into-r.html#cb235-4"></a>norm<span class="op">$</span>Mean &lt;-<span class="st"> </span><span class="kw">as.factor</span>(norm<span class="op">$</span>Mean)</span></code></pre></div>
<p>그리고 이렇게 만들어진 데이터프레임의 평균 값을 <code>Factor</code> 자료 유형으로 변환해줍니다. 이것이 의미하는 게 뭘까요? 평균5, 평균50, 평균20을 문자열로 인식하게 하여 일종의 “이름”으로 인식하게 만드는 것입니다. 그러면 이제 이렇게 만들어진 데이터로 그래프를 그려보겠습니다.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="probability-into-r.html#cb236-1"></a><span class="kw">ggplot</span>(norm, <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb236-2"><a href="probability-into-r.html#cb236-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">as.factor</span>(Mean)), <span class="dt">adjust =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb236-3"><a href="probability-into-r.html#cb236-3"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Mean, SD&quot;</span>)) <span class="op">+</span></span>
<span id="cb236-4"><a href="probability-into-r.html#cb236-4"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Mean, SD&quot;</span>)) <span class="op">+</span></span>
<span id="cb236-5"><a href="probability-into-r.html#cb236-5"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;5, 3&quot;</span>, <span class="st">&quot;20, 1&quot;</span>, <span class="st">&quot;50, 10&quot;</span>)) <span class="op">+</span></span>
<span id="cb236-6"><a href="probability-into-r.html#cb236-6"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;5, 3&quot;</span>, <span class="st">&quot;20, 1&quot;</span>, <span class="st">&quot;50, 10&quot;</span>)) <span class="op">+</span></span>
<span id="cb236-7"><a href="probability-into-r.html#cb236-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Probability Density Function</span><span class="ch">\n</span><span class="st">Normal Distribution&quot;</span>)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-100-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><code>ggplot2</code> 패키지는 <strong>R</strong>에서 그래프를 그리는 데 있어서 유용하게 사용됩니다. 먼저 <code>ggplot2</code> 패키지를 불러오고 나서, <code>ggplot(데이터프레임 이름, aes(x = x축으로 삼을 변수이름))</code>을 설정하면 일단 수학적으로 지정한 데이터의 변수에 대한 기본적인 작업은 진행이 됩니다.</p>
<p>그러나 이 단계에서는 아직 가시화(visualization)라고 할 수는 없는데, 주어진 데이터를 컴퓨팅했을 뿐이지 어떻게 가시적인 형태로 보여주라는 명령을 부여하지 않았기 때문입니다. 컴퓨터로 그림을 그려본 사람들은 이해가 쉬운데, <code>ggplot()</code>은 레이어 시스템을 이용해서, 우리가 뭔가 그려진 걸 얻고 싶을 때마다 레이어를 하나씩 추가해서 보여달라고 <strong>R</strong>에게 요구해야만 합니다.</p>
<p>그리고 이때, 레이어를 추가하는 것은 <code>+</code>로 가능합니다. 하나씩 뜯어서 보면,</p>
<ul>
<li><code>ggplot(norm, aes(x = x)) +</code> : <code>ggplot2</code> 패키지를 이용하여 <code>norm</code>이라는 데이터 프레임에서 <code>x</code>축에는 <code>x</code>라는 변수를 기준으로 늘어놓아라. 그리고 뒤에 더해지는 레이어 명령을 덮어 씌워라 라는 의미의 코드입니다.
<ul>
<li><code>geom_density(aes(fill = as.factor(Mean)), adjust = 4, alpha = 1/2) +</code>: 밀도함수의 형태로 그래프를 그리되, <code>Mean</code>이라는 <code>Factor</code> 변수가 같은 것들 끼리 같은 색으로 칠해서 보여주어라 라는 코드입니다.
<ul>
<li>뒤의 옵션은 세세한 조정이니 굳이 언급하지는 겠습니다.</li>
<li>뒤에 더해지는 옵션들은 레이어를 추가하여 기존의 코드에 덮어 씌워, 그래프를 덧칠하는 역할을 합니다.</li>
</ul></li>
<li><code>guides(color=guide_legend(title = "Mean, SD")) + guides(fill=guide_legend(title = "Mean, SD")) +</code>: 우측에 더해지는 레전드의 이름을 어떻게 지으라는 명령입니다.
<ul>
<li>이 경우에는 색도 있고 그래프를 선명하게 보여주는 선도 있기 때문에 그 각각이 레이어를 이루고 있어 둘 모두에게 이러한 명령어를 적용해야 합니다.</li>
</ul></li>
<li><code>scale_color_discrete(labels = c("5, 3", "20, 1", "50, 10")) +  scale_fill_discrete(labels = c("5, 3", "20, 1", "50, 10")) +</code>: <code>color</code>와 <code>fill</code>을 뒤에 이어지를 라벨로 구분해주라는 코드입니다.</li>
<li>ggtitle(<code>Probability Density Function\nNormal Distribution</code>) : 표 전체의 이름을 지정하는 명령어이고, <code>\n</code>은 <strong>R</strong>에서는 강제 개행(enter)하는 명령어입니다.</li>
</ul></li>
</ul>
</div>
<div id="이항분포-binomial-distribution" class="section level3">
<h3><span class="header-section-number">4.5.2</span> 이항분포 (Binomial distribution)</h3>
<p>이항분포는 우리에게 <code>n</code>번의 시행에서 <code>k</code>번 성공할 확률을 보여주는 분포입니다. 단순하게 말하자면 0과 1의 값만 갖는다고 가정된 벡터가 있다고 하겠습니다. 이때 벡터의 요소의 총 개수는 100개이고 랜덤으로 0과 1 중 하나가 벡터에 들어간다고 할 수 있습니다. 이때 전체 요소의 수 100개 중 1이 뽑혔을 경우를 계산하면 결국 1을 뽑을 성공 사례의 총합을 100으로 나눔으로써, 전체 대비 성공의 확률을 구하는 것이라 할 수 있습니다. 즉, 정규분포에서와는 다르게 이항분포에서는 평균(mean)이 아니라 비율(proportion)에 초점을 맞추게 됩니다.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="probability-into-r.html#cb237-1"></a><span class="kw">pbinom</span>(<span class="dv">27</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">prob=</span><span class="fl">0.25</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.7223805</code></pre>
<p>시도가 성공할 확률을 0.25라고 놓고 시행 횟수를 100번으로 가정한 경우입니다. 즉, 100번 시도했을 때 성공할 확률이 25%인 이항분포를 가지는 데, 실제로는 27번 성공했다고 한다면 누적확률에서 어느 위치에 해당하는지를 묻는 함수입니다. <code>lower.tail()</code>이 <code>TRUE</code>로 설정되어 있으므로 좌측에서부터 계산한 것입니다. 즉, 27번 성공한 것은 하위 72.2%, 상위 27.8%에 해당한다는 것을 알 수 있습니다.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="probability-into-r.html#cb239-1"></a><span class="kw">qbinom</span>(<span class="fl">0.7223805</span>, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">prob =</span> <span class="fl">0.25</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 27</code></pre>
<p>이렇게 구한 누적확률로 다시금 성공 횟수를 추정해보겠습니다. 정규분포때와 거의 유사합니다. <code>size = 100</code>은 서로 독립적인 사건의 시행, 즉 베르누이 시행(Bernoulli trials)의 횟수를 의미합니다. 그렇다면 100번 시도했을 때 27번 성공할 정확한 확률을 구해보겠습니다.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="probability-into-r.html#cb241-1"></a><span class="kw">dbinom</span>(<span class="dv">27</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">prob=</span><span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>## [1] 0.08064075</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="probability-into-r.html#cb243-1"></a><span class="kw">choose</span>(<span class="dv">100</span>, <span class="dv">27</span>)<span class="op">*</span>.<span class="dv">25</span><span class="op">^</span><span class="dv">27</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-.25</span>)<span class="op">^</span>(<span class="dv">100-27</span>)</span></code></pre></div>
<pre><code>## [1] 0.08064075</code></pre>
<p>두 가지 방법으로 구할 수 있는데, 첫 번째는 <strong>R</strong>에 내장된 기본 함수인 <code>dbinom()</code>으로 구하는 것입니다. 두 번째는 <code>choose()</code> 함수를 이용해서 구하는 것입니다. 개인적으로는 <code>dbinom()</code> 함수가 있는데 굳이 <code>choose()</code> 함수 사용법까지 알아야 하나 싶기는 합니다. 그러나 <code>choose()</code> 함수로 보여지는 식이 좀 더 직관적으로 이해하기에는 도움이 됩니다.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="probability-into-r.html#cb245-1"></a><span class="kw">rbinom</span>(<span class="dv">27</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">prob=</span><span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>##  [1] 25 27 27 28 26 24 26 30 32 22 24 22 25 37 28 25 24 25 23 34 23 26 26 23 32
## [26] 22 22</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="probability-into-r.html#cb247-1"></a><span class="kw">sd</span>(<span class="kw">rbinom</span>(<span class="dv">27</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">prob=</span><span class="fl">0.25</span>))</span></code></pre></div>
<pre><code>## [1] 4.597782</code></pre>
<p>마지막으로는 0.25의 확률을 가진 100번의 베르누이 시행을 27번을 반복하는 결과를 보여줍니다. 즉, 평균적으로는 100번 시행 중 25번의 성공을 할 것으로 기대되지만, 실제 시행을 27번 해보면 무작위 추출이기 때문에 25를 중심으로 표준편차 4.21의 범위 내에서 여러 값들이 추출되는 것을 확인할 수 있습니다. 무작위로 추출하기 때문에 돌릴 때마다 값은 다르게 나올 것입니다.</p>
<p>다시 한 번, <code>n</code>번의 독립적인 베르누이 사건을 시행할 때, <code>k</code>번 성공할 확률을 구하는 이항분포로 실습해보겠습니다. 구체적으로 모집단의 성공 확률을 <code>p</code>, 모집단의 크기를 <code>n</code>으로 특정하겠습니다.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="probability-into-r.html#cb249-1"></a>binom10 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">p =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">10</span>)</span>
<span id="cb249-2"><a href="probability-into-r.html#cb249-2"></a>binom50 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">p =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">50</span>)</span>
<span id="cb249-3"><a href="probability-into-r.html#cb249-3"></a>binom100 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">p =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>정규분포와 다르지는 않습니다. 다만 여기서의 <code>size</code>는 전체 동전을 던지는 횟수로 이해하면 되고 10,000은 그렇게 동전을 10번, 50번, 100번 던지는 걸 10,000번 반복한다는 의미라고 할 수 있습니다. 그럼 이제 마찬가지로 하나의 데이터프레임으로 세 번의 시도(<code>binom10</code>, <code>binom50</code>, <code>binom100</code>)의 결과를 합쳐주고 그래프를 그려보겠습니다.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="probability-into-r.html#cb250-1"></a>binom &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">k =</span> binom10, <span class="dt">Size =</span> <span class="dv">10</span>), </span>
<span id="cb250-2"><a href="probability-into-r.html#cb250-2"></a>                   <span class="kw">tibble</span>(<span class="dt">k =</span> binom50, <span class="dt">Size =</span> <span class="dv">50</span>), </span>
<span id="cb250-3"><a href="probability-into-r.html#cb250-3"></a>                   <span class="kw">tibble</span>(<span class="dt">k =</span> binom100, <span class="dt">Size =</span> <span class="dv">100</span>))</span>
<span id="cb250-4"><a href="probability-into-r.html#cb250-4"></a>binom<span class="op">$</span>Size &lt;-<span class="st"> </span><span class="kw">as.factor</span>(binom<span class="op">$</span>Size)</span>
<span id="cb250-5"><a href="probability-into-r.html#cb250-5"></a></span>
<span id="cb250-6"><a href="probability-into-r.html#cb250-6"></a><span class="kw">ggplot</span>(binom, <span class="kw">aes</span>(<span class="dt">x =</span> k)) <span class="op">+</span></span>
<span id="cb250-7"><a href="probability-into-r.html#cb250-7"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">group =</span> Size, <span class="dt">color =</span> Size, <span class="dt">fill =</span> Size), </span>
<span id="cb250-8"><a href="probability-into-r.html#cb250-8"></a>               <span class="dt">adjust =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb250-9"><a href="probability-into-r.html#cb250-9"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Probability Mass Function</span><span class="ch">\n</span><span class="st">Binomial Distribution&quot;</span>)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-106-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="포와송-분포-poison-distribution" class="section level3">
<h3><span class="header-section-number">4.5.3</span> 포와송 분포 (Poison distribution)</h3>
<p>이 포스팅은 주로 <strong>R</strong> 코드에 관한 것이기 때문에 분포에 대한 수리통계적인 설명은 가급적 피하도록 하겠습니다. 포와송 분포는 고정된 대규모 모집단(fixed large population)에서 짧은 시간에 걸쳐서 희소한 사건(rare events)의 발생 횟수를 추정하는 데 용이한 분포입니다.</p>
<p>포와송 분포에서 그 희소한 사건의 발생 확률은 시간 단위 별 발생의 평균 횟수로 나타나며 그리스어 람다(<code>Lambda</code>, <span class="math inline">\(\lambda\)</span>)로 표기됩니다. 람다는 평균과 분산을 결정합니다.</p>
<p>포와송 분포의 확률을 이용해서 우리는 단일 시간 단위에서 <code>k</code>라는 희소한 사건을 정확하게 관측할 확률을 기술할 수 있습니다. 나머지는 앞의 정규분포랑 이항분포에서 했던 코드를 기계적으로 반복해서 살펴보는 것과 같습니자. 단, 포와송 분포에서 코드 중에는 이전과 다른 부분이 있으니 그 점만 유의하면 될 것 같습니다.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="probability-into-r.html#cb251-1"></a>pois1 &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">lambda =</span> <span class="dv">1</span>)</span>
<span id="cb251-2"><a href="probability-into-r.html#cb251-2"></a>pois2 &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">lambda =</span> <span class="dv">2</span>)</span>
<span id="cb251-3"><a href="probability-into-r.html#cb251-3"></a>pois5 &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb251-4"><a href="probability-into-r.html#cb251-4"></a>pois20 &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">lambda =</span> <span class="dv">20</span>)</span>
<span id="cb251-5"><a href="probability-into-r.html#cb251-5"></a>pois &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Lambda.1 =</span> pois1, </span>
<span id="cb251-6"><a href="probability-into-r.html#cb251-6"></a>               <span class="dt">Lamnda.2 =</span> pois2,</span>
<span id="cb251-7"><a href="probability-into-r.html#cb251-7"></a>               <span class="dt">Lambda.5 =</span> pois5,</span>
<span id="cb251-8"><a href="probability-into-r.html#cb251-8"></a>               <span class="dt">Lambda.20 =</span> pois20)</span></code></pre></div>
<p>이번에는 만들어진 <code>pois</code>라는 데이터를 <code>melt()</code> 함수를 이용해서 다른 변수로 재구성해줄 것입니다. <code>melt()</code> 함수는 <code>reshape2</code> 패키지에서 로드할 수 있고, <code>str_extract()</code> 함수는 <code>stringr</code> 패키지에서 로드할 수 있다.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="probability-into-r.html#cb252-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb252-2"><a href="probability-into-r.html#cb252-2"></a><span class="kw">library</span>(stringr)</span>
<span id="cb252-3"><a href="probability-into-r.html#cb252-3"></a>pois &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="dt">data =</span> pois, </span>
<span id="cb252-4"><a href="probability-into-r.html#cb252-4"></a>             <span class="dt">variable.name =</span> <span class="st">&quot;Lambda&quot;</span>, </span>
<span id="cb252-5"><a href="probability-into-r.html#cb252-5"></a>             <span class="dt">value.name =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb252-6"><a href="probability-into-r.html#cb252-6"></a>pois<span class="op">$</span>Lambda &lt;-<span class="st"> </span></span>
<span id="cb252-7"><a href="probability-into-r.html#cb252-7"></a><span class="st">  </span><span class="kw">as.factor</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(<span class="dt">string =</span> </span>
<span id="cb252-8"><a href="probability-into-r.html#cb252-8"></a>                                     pois<span class="op">$</span>Lambda, </span>
<span id="cb252-9"><a href="probability-into-r.html#cb252-9"></a>                                   <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">d+&quot;</span>)))</span></code></pre></div>
<p>아래 그림에서 맨 왼쪽은 처음 만들어진 <code>pois</code> 데이터입니다. 두 번째는 <code>melt()</code> 함수를 이용해서 <code>Lambda</code>라는 변수 아래에 1, 2, 3, 4의 라벨을 길게(long-shape) 합친 것입니다. 그리고 마지막으로는 <code>Lambda</code> 변수의 문자열 <code>Lambda.</code>을 제외한 라벨 숫자만 남겨놓은 것입니다.</p>
<table>
<thead>
<tr class="header">
<th align="center"><code>pois</code> 데이터</th>
<th align="center"><code>long-shaped pois</code></th>
<th align="center"><code>label only</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><img src="r.post/pois1.png" /></td>
<td align="center"><img src="r.post/pois2.png" /></td>
<td align="center"><img src="r.post/pois3.png" /></td>
</tr>
</tbody>
</table>
<p>이렇게 만들어진 포와송 분포의 값들을 하나의 그래프로 만들어서 가시화해볼 수도 있습니다.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="probability-into-r.html#cb253-1"></a><span class="kw">ggplot</span>(pois, <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb253-2"><a href="probability-into-r.html#cb253-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">group =</span> Lambda, </span>
<span id="cb253-3"><a href="probability-into-r.html#cb253-3"></a>                   <span class="dt">color =</span> Lambda, </span>
<span id="cb253-4"><a href="probability-into-r.html#cb253-4"></a>                   <span class="dt">fill =</span> Lambda), </span>
<span id="cb253-5"><a href="probability-into-r.html#cb253-5"></a>               <span class="dt">adjust =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb253-6"><a href="probability-into-r.html#cb253-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Probability Mass Function</span><span class="ch">\n</span><span class="st">Poisson Distribution&quot;</span>)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-109-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="음이항-분포-negative-binomial-distribution" class="section level3">
<h3><span class="header-section-number">4.5.4</span> 음이항 분포 (Negative Binomial Distribution)</h3>
<p>음이항 분포는 <code>n</code>번째 시도에서 <code>k</code>번째에 성공할 확률을 보여줍니다. 음이항 분포는 다음과 같은 네 조건이 충족될 때 유용합니다.</p>
<ol style="list-style-type: decimal">
<li>모든 시도는 독립적이다.</li>
<li>각 시도의 결과는 성공 혹은 실패로 구분될 수 있다.</li>
<li>성공 확률 (<code>p</code>)은 각 시도마다 동일하다.</li>
<li>마지막 시도는 항상 성공이어야만 한다.</li>
</ol>
<p>여기서 보면 알 수 있듯이, 처음 세 조건은 이항분포와 동일합니다. 세 개의 음이항 분포 결과를 계산하여 세 개의 벡터로 저장하겠습니다. 그리고 이걸 마찬가지로 하나의 데이터로 합칩니다.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="probability-into-r.html#cb254-1"></a>nbinom1 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">p =</span> <span class="fl">.3</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span>
<span id="cb254-2"><a href="probability-into-r.html#cb254-2"></a>nbinom5 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">p =</span> <span class="fl">.3</span>, <span class="dt">size =</span> <span class="dv">5</span>)</span>
<span id="cb254-3"><a href="probability-into-r.html#cb254-3"></a>nbinom10 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">p =</span> <span class="fl">.3</span>, <span class="dt">size =</span> <span class="dv">10</span>)</span>
<span id="cb254-4"><a href="probability-into-r.html#cb254-4"></a>nbinom &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">x =</span> nbinom1, <span class="dt">Size =</span> <span class="dv">1</span>), </span>
<span id="cb254-5"><a href="probability-into-r.html#cb254-5"></a>                    <span class="kw">tibble</span>(<span class="dt">x =</span> nbinom5, <span class="dt">Size =</span> <span class="dv">5</span>), </span>
<span id="cb254-6"><a href="probability-into-r.html#cb254-6"></a>                    <span class="kw">tibble</span>(<span class="dt">x =</span> nbinom10, <span class="dt">Size =</span> <span class="dv">10</span>))</span>
<span id="cb254-7"><a href="probability-into-r.html#cb254-7"></a>nbinom<span class="op">$</span>Size &lt;-<span class="st"> </span><span class="kw">as.factor</span>(nbinom<span class="op">$</span>Size)</span></code></pre></div>
<p>포와송이랑 이항분포에서 사용했던 함수들과 거의 유사합니다. 이렇게 만들어진 그래프는 다음과 같습니다.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="probability-into-r.html#cb255-1"></a><span class="kw">ggplot</span>(nbinom, <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb255-2"><a href="probability-into-r.html#cb255-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">group =</span> Size, <span class="dt">color =</span> Size, <span class="dt">fill =</span> Size), </span>
<span id="cb255-3"><a href="probability-into-r.html#cb255-3"></a>               <span class="dt">adjust =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb255-4"><a href="probability-into-r.html#cb255-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Probability Mass Function</span><span class="ch">\n</span><span class="st">Negative Binomial Distribution&quot;</span>)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-111-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="f-분포-f-distribution" class="section level3">
<h3><span class="header-section-number">4.5.5</span> F 분포 (F Distribution)</h3>
<p><code>rf()</code>를 통해서 F 분포에서 무작위로 10,000개의 값을 서로 다른 자유도를 이용하여 추출하여 네 개의 벡터에 저장합니다. 이제는 아시겠지만 <code>rf()</code>의 <code>r</code>은 random을 의미합니다.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="probability-into-r.html#cb256-1"></a>fa &lt;-<span class="st"> </span><span class="kw">rf</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">df1 =</span> <span class="dv">1</span>, <span class="dt">df2 =</span> <span class="dv">50</span>)</span>
<span id="cb256-2"><a href="probability-into-r.html#cb256-2"></a>fb &lt;-<span class="st"> </span><span class="kw">rf</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">df1 =</span> <span class="dv">5</span>, <span class="dt">df2 =</span> <span class="dv">100</span>)</span>
<span id="cb256-3"><a href="probability-into-r.html#cb256-3"></a>fc &lt;-<span class="st"> </span><span class="kw">rf</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">df1 =</span> <span class="dv">50</span>, <span class="dt">df2 =</span> <span class="dv">50</span>)</span>
<span id="cb256-4"><a href="probability-into-r.html#cb256-4"></a>fd &lt;-<span class="st"> </span><span class="kw">rf</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">df1 =</span> <span class="dv">50</span>, <span class="dt">df2 =</span> <span class="dv">500</span>)</span>
<span id="cb256-5"><a href="probability-into-r.html#cb256-5"></a>f &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">x =</span> fa, <span class="dt">DF1 =</span> <span class="dv">5</span>, <span class="dt">DF2 =</span> <span class="dv">5</span>), </span>
<span id="cb256-6"><a href="probability-into-r.html#cb256-6"></a>               <span class="kw">tibble</span>(<span class="dt">x =</span> fb, <span class="dt">DF1 =</span> <span class="dv">5</span>, <span class="dt">DF2 =</span> <span class="dv">10</span>), </span>
<span id="cb256-7"><a href="probability-into-r.html#cb256-7"></a>               <span class="kw">tibble</span>(<span class="dt">x =</span> fc, <span class="dt">DF1 =</span> <span class="dv">10</span>, <span class="dt">DF2 =</span> <span class="dv">5</span>),</span>
<span id="cb256-8"><a href="probability-into-r.html#cb256-8"></a>               <span class="kw">tibble</span>(<span class="dt">x =</span> fd, <span class="dt">DF1 =</span> <span class="dv">10</span>, <span class="dt">DF2 =</span> <span class="dv">10</span>))</span></code></pre></div>
<p>이렇게 만들어진 데이터의 결과는 그림과 같습니다. 그리고 이제 <code>x</code> 값이 6보다 작거나 같은 경우로 하위 데이터를 만듭니다. 왜냐하면 굉장히 극단적인 수치들이 희소한 확률로 있기 때문에 그냥 그래프를 그리면 집단 별 차이를 보기가 조금 힘들 수도 있기 때문입니다. 그리고 전체 자유도를 지정해줄 것입니다. 자세한 내용은 나중에 <code>F-distribution</code>을 언급할 때 설명하도록 하겠습니다.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="probability-into-r.html#cb257-1"></a>f &lt;-<span class="st"> </span><span class="kw">subset</span>(f, x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb257-2"><a href="probability-into-r.html#cb257-2"></a>f<span class="op">$</span>DF &lt;-<span class="st"> </span>f<span class="op">$</span>DF1 <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span>f<span class="op">$</span>DF2</span>
<span id="cb257-3"><a href="probability-into-r.html#cb257-3"></a>f<span class="op">$</span>DF &lt;-<span class="st"> </span><span class="kw">as.factor</span>(f<span class="op">$</span>DF)</span>
<span id="cb257-4"><a href="probability-into-r.html#cb257-4"></a></span>
<span id="cb257-5"><a href="probability-into-r.html#cb257-5"></a><span class="kw">ggplot</span>(f, <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb257-6"><a href="probability-into-r.html#cb257-6"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">color =</span> DF, <span class="dt">fill =</span> DF), <span class="dt">adjust =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb257-7"><a href="probability-into-r.html#cb257-7"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;DF1, DF2&quot;</span>)) <span class="op">+</span></span>
<span id="cb257-8"><a href="probability-into-r.html#cb257-8"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;DF1, DF2&quot;</span>)) <span class="op">+</span></span>
<span id="cb257-9"><a href="probability-into-r.html#cb257-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1, 50&quot;</span>, <span class="st">&quot;5, 500&quot;</span>, <span class="st">&quot;50, 50&quot;</span>, <span class="st">&quot;50, 500&quot;</span>)) <span class="op">+</span></span>
<span id="cb257-10"><a href="probability-into-r.html#cb257-10"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1, 50&quot;</span>, <span class="st">&quot;5, 500&quot;</span>, <span class="st">&quot;50, 50&quot;</span>, <span class="st">&quot;50, 500&quot;</span>)) <span class="op">+</span></span>
<span id="cb257-11"><a href="probability-into-r.html#cb257-11"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Probability Density Function</span><span class="ch">\n</span><span class="st">F Distribution&quot;</span>)</span></code></pre></div>
<p><img src="Kor_BasicStats_files/figure-html/unnamed-chunk-113-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><code>DF1</code>이랑 <code>DF2</code>를 합쳐준다는 것은 F-분포의 특징 때문인데, 간단하게 말하자면 t-분포와 다르게 F-분포는 분자, 분모에 자유도가 하나씩 즉 2개가 필요하기 때문입니다.</p>
<p>오늘 포스팅한 내용 중에서는 처음 두 분포, 정규분포와 이항분포에 대해서는 숙지할 필요가 있고 나머지 분포들은 추후에 다시 다룰 기회가 있을 것이라고 생각합니다. 사실 분포는 엄청 많습니다: 웨이블, 토빗… 뭐 여럿 있기 때문에 다 외우는 것은 어렵고 여기서는 단지 R-code로 구현하는 방법을 러프하게 살펴보았다고 할 수 있을 것입니다.</p>
<p>그리고 <code>ggplot()</code>은 손에 익도록 연습하는 것이 좋습니다. <strong>R</strong>의 장점 중 하나는 여타의 통계툴들에 비해 그래프 기능이 뛰어나다는 것입니다. <code>ggplot()</code>은 <strong>R</strong>이 그러한 명성을 얻게 해 준 공신 중 하나라고 할 수 있습니다.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>뒤의 <code>rnorm()</code>을 이용하여 무작위로 생성한 100개의 값을 구했기 때문에, 이 결과는 구할 때마다 달라질 것입니다.<a href="probability-into-r.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="foundation-of-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Prop2R.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Kor_BasicStats.pdf", "Kor_BasicStats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
